(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{109:function(e,t){e.exports="data:image/jpeg;base64,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"},110:function(e,t,a){e.exports=a(224)},115:function(e,t,a){},116:function(e,t,a){},163:function(e,t){},224:function(e,t,a){"use strict";a.r(t);var n=a(0),A=a.n(n),r=a(100),o=a.n(r),s=(a(115),a(34)),c=a(8),i=(a(116),a(101)),l=a(21),d=a(22),u=a(25),m=a(24),p=a(225),f=a(226),h=a(227),g=a(231),v=a(230),b=a(102),y=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onSubmit=function(){var e={operation:n.state.selected_op,problem:n.state.selected_problem};console.log(e),n.props.history.push("/connect?op=".concat(e.operation,"&problem=").concat(e.problem))},n.onChange=function(e){n.setState(Object(i.a)({},e.target.id,e.target.value))},n.state={problems:["lonely","suicidal","extremely depressed","homesick","betrayed","the loss of loved one","like committing self-harm"],ops:["help","seek help"],selected_op:"help",selected_problem:"lonely",isdrop_1:!1,isdrop_2:!1},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t="help"==this.state.selected_op?"someone who feels":"because I feel",a=this.state.problems.map((function(t,a){return A.a.createElement(p.a,{key:a,value:t,id:"selected_problem",onClick:e.onChange,index:a},t)}));return A.a.createElement("div",{className:"landing"},A.a.createElement("div",{className:"heading-text"},"Save Our Soul"),A.a.createElement("div",{className:"center"},A.a.createElement(f.a,{noValidate:!0,onSubmit:this.onSubmit},A.a.createElement("h1",null,"I am here to"),A.a.createElement("div",{className:"drop-it"},A.a.createElement(h.a,{isOpen:this.state.isdrop_1,toggle:function(){return e.setState({isdrop_1:!e.state.isdrop_1})}},A.a.createElement(g.a,{className:"menu",caret:!0},this.state.selected_op),A.a.createElement(v.a,null,A.a.createElement(p.a,{value:"help",id:"selected_op",onClick:this.onChange},"help"),A.a.createElement(p.a,{value:"seek help",id:"selected_op",onClick:this.onChange},"seek help")))),A.a.createElement("h1",null,t),A.a.createElement("div",{className:"drop-it"},A.a.createElement(h.a,{isOpen:this.state.isdrop_2,toggle:function(){return e.setState({isdrop_2:!e.state.isdrop_2})}},A.a.createElement(g.a,{className:"menu",caret:!0},this.state.selected_problem),A.a.createElement(v.a,null,a))),A.a.createElement(b.a,{className:"chat-btn"},"Start Chat")),A.a.createElement("br",null),A.a.createElement("div",{className:"intro"},"Hey! We know quarantine has been hard on all of us. We are separated from our family, have to face the loss of our loved ones. Even if you just feel lonely or depressed, we want you to know we are here for you. Here you can seek help from your peers. We hope this helps!!")))}}]),a}(n.Component),E=Object(c.f)(y),w=a(28),N=a.n(w),S=a(106),k=a(36),x=a(53),O=a(107),K=a.n(O),j=a(108),L=a.n(j),W=a(109),F=a.n(W);function U(e){var t=e.isLoading,a=e.messages,n=e.user,r=e.renderMessage,o=A.a.createElement("div",{className:"loading-messages-container"},A.a.createElement(L.a,{size:"100",singleColor:"grey"}),A.a.createElement("span",{className:"loading-text"},"Loading Messages"));return!t&&a.length?a.map((function(e){if(r)return r(e);var t,a=n.uid===e.sender.uid,o="sys"===e.sender.uid;return t=a?null:A.a.createElement("div",{className:"sender-name"},e.sender.name),o?A.a.createElement("div",{key:e.id,className:"chat-bubble-row",style:{flexDirection:"row"}},A.a.createElement("div",{className:"message chat-bubble is-sys",style:{color:"#2D313F"}},e.text)):A.a.createElement("div",{key:e.id,className:"chat-bubble-row",style:{flexDirection:a?"row-reverse":"row"}},A.a.createElement("img",{src:F.a,alt:"sender avatar",className:"avatar",style:a?{marginLeft:"15px"}:{marginRight:"15px"}}),A.a.createElement("div",{className:"chat-bubble ".concat(a?"is-user":"is-other")},t,A.a.createElement("div",{className:"message",style:{color:a?"#FFF":"#2D313F"}},e.text)))})):o}var J=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleSendMessage=function(e){e.preventDefault();var t=n.state.message;n.props.sendMessage(t),n.setState({message:""})},n.scrollToBottom=function(){document.getElementById("end-of-chat").scrollIntoView()},n.state={message:"",user:e.user,messages:e.messages},n}return Object(d.a)(a,[{key:"componentDidUpdate",value:function(e,t){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.state.message;return A.a.createElement("div",{className:"chat-box"},A.a.createElement("div",{className:"msg-page"},A.a.createElement(U,{isLoading:this.props.isLoading,messages:this.props.messages,user:this.props.user,renderMessage:this.props.renderMessage}),A.a.createElement("div",{className:"chat-box-bottom"},A.a.createElement("div",{id:"end-of-chat"}))),A.a.createElement("div",{className:"msg-footer"},A.a.createElement("form",{className:"message-form",onSubmit:this.handleSendMessage},A.a.createElement("div",{className:"input-group"},A.a.createElement("input",{type:"text",className:"form-control message-input",placeholder:"Type something",value:t,onChange:function(t){return e.setState({message:t.target.value})},required:!0})))))}}]),a}(n.Component);J.defaultProps={user:{uid:"user1"},isLoading:!1};var V,B,C,R,M=J,P=a(228),T=a(229),q=["Feel better!","Stay positive! \ud83d\ude01","Quarantine will end soon!","It will pass. \u231b","You will feel better.","More power to you! \ud83d\udcaa","We will get through this.","This too shall pass!!","Believe in yourself...","Love yourself...\ud83e\udde1","We are here for you! \ud83d\ude0c","Corona Virus will end!","We will meet our friends soon. ","We are in this together","You are not alone!!! \ud83d\udc9e"],D=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={id:q[0]},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){var t=Math.floor(Math.random()*q.length);e.setState({id:q[t]})}),1e4)}},{key:"render",value:function(){return A.a.createElement(P.a,{className:"navbar-main",light:!0,fixed:"top"},A.a.createElement(T.a,{className:"ml-left"},this.state.id),A.a.createElement("p",{className:"brand-aaa",href:"/"},"SaveOurSoul"),A.a.createElement(T.a,null,A.a.createElement("div",{className:"online-count"},A.a.createElement("strong",null,"x")," online now")))}}]),a}(n.Component),z=a(51),H=a.n(z);H.a.setApiKey("bc5faa9f-b64f-46fb-a1a3-3f577fd12f1c");var Q=[],I={iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},X={video:{facingMode:"user"}};function Z(){var e=new URLSearchParams(Object(c.e)().search),t={op:e.get("op"),problem:e.get("problem")},a=Object(n.useState)(!1),r=Object(x.a)(a,2),o=r[0],s=r[1],i=Object(n.useState)([]),l=Object(x.a)(i,2),d=l[0],u=l[1];function m(e){console.log(e),Q=[].concat(Object(k.a)(Q),[{text:e,id:d.length+1,sender:{name:"System",uid:"sys"}}]),u(Q)}function p(e){switch(e){case"partner_connected":Q=[],u([]),m("You're now chatting with a random stranger. Say hi!");break;case"waiting_partner":m("Looking for someone you can talk to...");break;case"partner_disconnected":m("Sorry. stranger has disconnected."),m("Click on next to start a new chat.");break;case"server_disconnection":m("System error! Please refresh this page!");break;default:m(e)}}function f(e){console.log(Q),Q=[].concat(Object(k.a)(Q),[{text:e.content,id:d.length+1,sender:{name:"Stranger",uid:"user2"}}]),u(Q)}function h(){g(),v(),s(!1),V.emit("next")}function g(){s(!1),R&&R.close&&R.close(),R=null,V.emit("leaving")}function v(){V.emit("info",t)}function b(e){switch(e){case"partner_connected":s(!0),console.log("Found a partner");break;case"partner_disconnected":g();break;case"waiting_partner":v(),s(!1);break;default:console.log("Invalid code")}p(e)}function y(){return(y=Object(S.a)(N.a.mark((function e(){var t,a,n;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o&&(console.log("Reporting your partner"),t=document.createElement("canvas"),a=t.getContext("2d"),t.width=C.videoWidth,t.height=C.videoHeight,a.drawImage(C,0,0,t.width,t.height),n=t.toDataURL("image/jpeg",.8),H.a.callStandardApi("content-moderation",{image:n}).then((function(e){console.log(e);var t=Number(e.output.nsfw_score);t>=.6?(alert("Reporting. Found content consisting of nudity in partner's stream (nsfw score: ".concat(t.toFixed(3),").")),h()):alert("Invalid report. Moderated content. ".concat(t.toFixed(3)))})).catch((function(e){console.log(e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return A.a.useEffect((function(){V=K()("http://localhost:4000"),B=document.getElementById("localVideo"),C=document.getElementById("remoteVideo"),navigator.mediaDevices.getUserMedia(X).then((function(e){return B.srcObject=e})).catch((function(e){return console.log(e)})),h(),V.on("sysinfo",b),V.on("msg",f),V.on("ready",(function(){console.log("Client is getting ready",B,C),(R=new RTCPeerConnection(I)).addStream(B.srcObject),R.createOffer().then((function(e){return R.setLocalDescription(e)})).then((function(){console.log("client emitting offer",R.localDescription),V.emit("ready",R.localDescription)})),R.onaddstream=function(e){C.srcObject=e.stream,console.log("Setting remote video stream")},R.onicecandidate=function(e){e.candidate&&V.emit("candidate",e.candidate)}})),V.on("offer",(function(e){var t=new RTCPeerConnection(I);B instanceof HTMLVideoElement&&t.addStream(B.srcObject),t.setRemoteDescription(e).then((function(){return t.createAnswer()})).then((function(e){return t.setLocalDescription(e)})).then((function(){V.emit("offer_ok",t.localDescription)})),t.onaddstream=function(e){C.srcObject=e.stream},t.onicecandidate=function(e){e.candidate&&V.emit("candidate",e.candidate)}})),V.on("answer",(function(e){R&&R.setRemoteDescription(e)})),V.on("candidate",(function(e){R&&R.addIceCandidate(new RTCIceCandidate(e))})),V.on("disconnect",(function(){return b("server_disconnection")})),V.on("leaving",(function(){return b("partner_disconnected")}))}),[]),A.a.createElement("div",{className:"conn"},A.a.createElement("div",{className:"row"},A.a.createElement(D,null)),A.a.createElement("br",null),A.a.createElement("br",null),A.a.createElement("div",{className:"row"},A.a.createElement("div",{className:"column chat-column"},A.a.createElement(M,{className:"chat-column",sendMessage:function(e){return o&&e.replace(/\s+/g,"").length>0?(V.emit("msg",e),Q=[].concat(Object(k.a)(d),[{text:e,id:d.length+1,sender:{name:"Me",uid:"user1"}}]),u(Q),!0):(m("You cannot chat without a partner!"),!1)},messages:d,isLoading:!1})),A.a.createElement("div",{className:"column video-column"},A.a.createElement("div",{className:"row video-row"},A.a.createElement("video",{className:"vid",id:"remoteVideo",style:{display:o?"block":"none"},playsInline:!0,autoPlay:!0}),!o&&A.a.createElement("div",{className:"vid",id:"videoPlaceholder"},A.a.createElement("img",{id:"loadingGif",src:"https://cdn.dribbble.com/users/1303437/screenshots/4952713/attachments/1110126/abstract-loader-white.gif",alt:"loading"})),A.a.createElement("video",{className:"vid",id:"localVideo",playsInline:!0,autoPlay:!0})),A.a.createElement("div",{className:"row button-row"},A.a.createElement("button",{className:"button",onClick:h},A.a.createElement("i",{className:"fa fa-arrow-circle-right button-left-icon"}),"Next"),A.a.createElement("button",{className:"button",onClick:function(){return y.apply(this,arguments)}},A.a.createElement("i",{className:"fa fa-flag button-left-icon",style:{fontSize:"medium"}}),"Report")))))}var G=function(){return A.a.createElement(s.a,null,A.a.createElement("div",{className:"App"},A.a.createElement(c.a,{exact:!0,path:"/",component:E}),A.a.createElement(c.a,{path:"/connect",component:Z})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(223);var Y=a(52),_=a.n(Y);function $(){_.a.getJSON(window.serverURI,(function(e){_()(".online-count>strong").text(e.usersOnline)}))}window.serverURI="http://localhost:4000",$(),setInterval($,1e3),o.a.render(A.a.createElement(A.a.StrictMode,null,A.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[110,1,2]]]);
//# sourceMappingURL=main.8144ea08.chunk.js.map